knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(wmwpow)
simfun <- function(nblocks=10, means=c(1,1), within.sd=1, between.sd=1) {
g <- factor(rep(seq_len(nblocks), each=length(means)))
t <- rep(seq_along(means), nblocks)
y <- means[t] + rnorm(nblocks, 0, between.sd)[g] + rnorm(length(g),
0, within.sd)
friedman.test(y ~ t | g)$p.value
}
# test size of test
set.seed(112358)
out2 <- lapply(5:20, function(n) replicate(1000, simfun(nblocks=n, means=c(1,2,3))))
lapply(out2, function(x) mean(out2[[x]] <= 0.05))
